(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{8966:(e,t,a)=>{Promise.resolve().then(a.bind(a,887))},887:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>b});var l=a(5155),r=a(2115);let i=(0,r.createContext)({width:200,height:60,updateSetting:()=>{}}),n=e=>{let{children:t}=e,[a,n]=(0,r.useState)(150),[s,u]=(0,r.useState)(60);return(0,l.jsx)(i.Provider,{value:{width:a,height:s,updateSetting:(e,t)=>{n(e),u(t)}},children:t})},s=()=>(0,r.useContext)(i),u=new(a(8559)).Ay.binanceusdm;async function h(){let e=await u.loadMarkets();return console.log(e),Object.values(e).filter(e=>void 0!==e&&"USDT"===e.quote&&e.swap&&(void 0===e.active||e.active)).map(e=>{var t,a,l;return{symbol:(null==e?void 0:null===(t=e.id)||void 0===t?void 0:t.toString())||"",baseAsset:(null==e?void 0:null===(a=e.base)||void 0===a?void 0:a.toString())||"",quoteAsset:(null==e?void 0:null===(l=e.quote)||void 0===l?void 0:l.toString())||""}})}async function o(e){return(await u.fapiPublicGetPremiumIndexKlines({symbol:e,interval:"5m"})).map(e=>{let[t,a,l,r,i]=e;return{time:Math.floor((null!=t?t:0)/1e3),open:100*Number(a),high:100*Number(l),low:100*Number(r),close:100*Number(i)}})}let c=(e,t,a)=>{let l=e.getContext("2d");if(!l)return;l.clearRect(0,0,e.width,e.height),l.save();let r=Math.max(Math.abs(Math.max(...t.map(e=>e.value),.09)),Math.abs(Math.min(...t.map(e=>e.value),-.07))),i=e.height/2/r,n=e.width/t.length,s=a[a.length-1].value,u="rgba(34, 197, 94, 1)";switch(!0){case s<-.04:u="rgba(239, 68, 68, 1)";break;case s<0:u="rgba(249, 115, 22, 1)";break;case s<.06:u="rgba(59, 130, 246, 1)"}l.strokeStyle=u,l.lineWidth=2,l.strokeRect(0,0,e.width,e.height),l.beginPath();let h=0*i-e.height/2;l.translate(0,h),l.beginPath(),l.strokeStyle="rgb(215, 245, 49)",l.lineWidth=1,l.moveTo(0,e.height-a[0].value*i);for(let t=1;t<a.length;t++)l.lineTo(t*n,e.height-a[t].value*i);l.stroke(),l.beginPath(),l.strokeStyle="gray",l.lineWidth=1,l.moveTo(0,e.height),l.lineTo(e.width,e.height),l.stroke(),l.fillStyle="rgba(252, 252, 252, 0.05)",l.fillRect(0,e.height-.06*i,e.width,.1*i),l.restore()};function m(e){let{symbol:t}=e,a=(0,r.useRef)(null),{width:i,height:n}=s(),[u,h]=(0,r.useState)(null);return(0,r.useEffect)(()=>{(async()=>{let e=await o(t);h({emaData:function(e,t){let a=[e[0].close];for(let t=1;t<e.length;t++){let l=2/7;a.push(e[t].close*l+a[t-1]*(1-l))}return a.map((t,a)=>({time:e[a].time,value:t}))}(e,0),iwmaData:function(e,t){let a=Array.from({length:96},(e,t)=>1/(t+1)),l=a.reduce((e,t)=>e+t,0),r=[e[0].value];for(let t=1;t<e.length;t++){let i=a.reduce((a,l,r)=>{let i=t-r;return i>=0?a+e[i].value*l:a},0);r.push(i/l)}return r.map((t,a)=>({time:e[a].time,value:t}))}(e.map(e=>{let{time:t,high:a,low:l,close:r}=e;return{time:t,value:(a+l+r)/3}}),0)})})()},[t]),(0,r.useEffect)(()=>{a.current&&u&&c(a.current,u.emaData,u.iwmaData)},[t,u,i,n]),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-white text-sm",children:t}),(0,l.jsx)("canvas",{ref:a,width:i,height:n})]})}let d=()=>{let{width:e,height:t,updateSetting:a}=s(),[i,n]=(0,r.useState)(e),[u,h]=(0,r.useState)(t);return(0,l.jsx)("form",{onSubmit:e=>{e.preventDefault(),a(i,u)},className:"mb-2 p-2 border rounded",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)("label",{className:"flex items-center",children:["Width:",(0,l.jsx)("input",{type:"number",value:i,onChange:e=>n(Number(e.target.value)),className:"border ml-2 px-2 py-1 text-black"})]}),(0,l.jsxs)("label",{className:"flex items-center",children:["Height:",(0,l.jsx)("input",{type:"number",value:u,onChange:e=>h(Number(e.target.value)),className:"border ml-2 px-2 py-1 text-black"})]}),(0,l.jsx)("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",children:"更新"})]})})};function b(){let[e,t]=(0,r.useState)([]);return(0,r.useEffect)(()=>{h().then(e=>{t(e.map(e=>e.symbol))})},[]),(0,l.jsx)(n,{children:(0,l.jsxs)("div",{className:"container mx-auto px-2",children:[(0,l.jsx)(d,{}),(0,l.jsx)("div",{className:"flex flex-wrap gap-0.5",children:e.map(e=>(0,l.jsx)("div",{children:(0,l.jsx)(m,{symbol:e})},e))})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[814,509,447,515,232,938,535,202,8,798,426,652,347,793,886,616,553,472,295,323,195,198,28,419,137,846,441,517,358],()=>t(8966)),_N_E=e.O()}]);